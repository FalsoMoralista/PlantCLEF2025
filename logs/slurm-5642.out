INFO:root:called-params config/feature_extraction.yaml
INFO:root:loaded params...
INFO:root:{'num_workers': 32, 'base_dir': '/home/rtcalumby/adam/luciano/PlantCLEF2025/PlantCLEF2025/', 'pretrained_path': 'pretrained_models/vit_base_patch14_reg4_dinov2_lvd142m_pc24_onlyclassifier_then_all/model_best.pth.tar', 'data': {'class_mapping': 'pretrained_models/class_mapping.txt', 'species_mapping': 'pretrained_models/species_id_to_name.txt', 'train_data': '/home/rtcalumby/adam/luciano/PlantCLEF2025/images_max_side_800/', 'output_dir': '/home/rtcalumby/adam/luciano/PlantCLEF2025/cached_features/'}}
INFO:root:Running... (rank: 0/2)
INFO:root:Initialized (rank/world-size) 0/2
INFO:timm.models._helpers:Loaded state_dict_ema from checkpoint 'pretrained_models/vit_base_patch14_reg4_dinov2_lvd142m_pc24_onlyclassifier_then_all/model_best.pth.tar'
Train dataset created for rank 1,/2
Data Loader length: 344 process_id: 1
Train dataset created for rank 0,/2
Data Loader length: 344 process_id: 0
INFO:root:Iteration [1/343]
INFO:root:Iteration [2/343]
INFO:root:Iteration [3/343]
INFO:root:Iteration [4/343]
INFO:root:Iteration [5/343]
INFO:root:Iteration [6/343]
INFO:root:Iteration [7/343]
INFO:root:Iteration [8/343]
INFO:root:Iteration [9/343]
INFO:root:Iteration [10/343]
INFO:root:Iteration [11/343]
INFO:root:Iteration [12/343]
INFO:root:Iteration [13/343]
INFO:root:Iteration [14/343]
INFO:root:Iteration [15/343]
INFO:root:Iteration [16/343]
INFO:root:Iteration [17/343]
INFO:root:Iteration [18/343]
INFO:root:Iteration [19/343]
INFO:root:Iteration [20/343]
INFO:root:Iteration [21/343]
INFO:root:Iteration [22/343]
INFO:root:Iteration [23/343]
INFO:root:Iteration [24/343]
INFO:root:Iteration [25/343]
INFO:root:Iteration [26/343]
INFO:root:Iteration [27/343]
INFO:root:Iteration [28/343]
INFO:root:Iteration [29/343]
INFO:root:Iteration [30/343]
INFO:root:Iteration [31/343]
INFO:root:Iteration [32/343]
INFO:root:Iteration [33/343]
INFO:root:Iteration [34/343]
INFO:root:Iteration [35/343]
INFO:root:Iteration [36/343]
INFO:root:Iteration [37/343]
INFO:root:Iteration [38/343]
INFO:root:Iteration [39/343]
INFO:root:Iteration [40/343]
INFO:root:Iteration [41/343]
INFO:root:Iteration [42/343]
INFO:root:Iteration [43/343]
INFO:root:Iteration [44/343]
INFO:root:Iteration [45/343]
INFO:root:Iteration [46/343]
INFO:root:Iteration [47/343]
INFO:root:Iteration [48/343]
INFO:root:Iteration [49/343]
INFO:root:Iteration [50/343]
INFO:root:Iteration [51/343]
INFO:root:Iteration [52/343]
INFO:root:Iteration [53/343]
INFO:root:Iteration [54/343]
INFO:root:Iteration [55/343]
INFO:root:Iteration [56/343]
INFO:root:Iteration [57/343]
INFO:root:Iteration [58/343]
INFO:root:Iteration [59/343]
INFO:root:Iteration [60/343]
INFO:root:Iteration [61/343]
INFO:root:Iteration [62/343]
INFO:root:Iteration [63/343]
INFO:root:Iteration [64/343]
INFO:root:Iteration [65/343]
INFO:root:Iteration [66/343]
INFO:root:Iteration [67/343]
INFO:root:Iteration [68/343]
INFO:root:Iteration [69/343]
INFO:root:Iteration [70/343]
INFO:root:Iteration [71/343]
INFO:root:Iteration [72/343]
INFO:root:Iteration [73/343]
INFO:root:Iteration [74/343]
INFO:root:Iteration [75/343]
INFO:root:Iteration [76/343]
INFO:root:Iteration [77/343]
INFO:root:Iteration [78/343]
INFO:root:Iteration [79/343]
INFO:root:Iteration [80/343]
INFO:root:Iteration [81/343]
INFO:root:Iteration [82/343]
INFO:root:Iteration [83/343]
INFO:root:Iteration [84/343]
INFO:root:Iteration [85/343]
INFO:root:Iteration [86/343]
INFO:root:Iteration [87/343]
INFO:root:Iteration [88/343]
INFO:root:Iteration [89/343]
INFO:root:Iteration [90/343]
INFO:root:Iteration [91/343]
INFO:root:Iteration [92/343]
INFO:root:Iteration [93/343]
INFO:root:Iteration [94/343]
INFO:root:Iteration [95/343]
INFO:root:Iteration [96/343]
INFO:root:Iteration [97/343]
INFO:root:Iteration [98/343]
INFO:root:Iteration [99/343]
INFO:root:Iteration [100/343]
INFO:root:Iteration [101/343]
INFO:root:Iteration [102/343]
INFO:root:Iteration [103/343]
INFO:root:Iteration [104/343]
INFO:root:Iteration [105/343]
INFO:root:Iteration [106/343]
INFO:root:Iteration [107/343]
INFO:root:Iteration [108/343]
INFO:root:Iteration [109/343]
INFO:root:Iteration [110/343]
INFO:root:Iteration [111/343]
INFO:root:Iteration [112/343]
INFO:root:Iteration [113/343]
INFO:root:Iteration [114/343]
INFO:root:Iteration [115/343]
INFO:root:Iteration [116/343]
INFO:root:Iteration [117/343]
INFO:root:Iteration [118/343]
INFO:root:Iteration [119/343]
INFO:root:Iteration [120/343]
INFO:root:Iteration [121/343]
INFO:root:Iteration [122/343]
INFO:root:Iteration [123/343]
INFO:root:Iteration [124/343]
INFO:root:Iteration [125/343]
INFO:root:Iteration [126/343]
INFO:root:Iteration [127/343]
INFO:root:Iteration [128/343]
INFO:root:Iteration [129/343]
INFO:root:Iteration [130/343]
INFO:root:Iteration [131/343]
INFO:root:Iteration [132/343]
INFO:root:Iteration [133/343]
INFO:root:Iteration [134/343]
INFO:root:Iteration [135/343]
INFO:root:Iteration [136/343]
INFO:root:Iteration [137/343]
INFO:root:Iteration [138/343]
INFO:root:Iteration [139/343]
INFO:root:Iteration [140/343]
INFO:root:Iteration [141/343]
INFO:root:Iteration [142/343]
INFO:root:Iteration [143/343]
INFO:root:Iteration [144/343]
INFO:root:Iteration [145/343]
INFO:root:Iteration [146/343]
INFO:root:Iteration [147/343]
INFO:root:Iteration [148/343]
INFO:root:Iteration [149/343]
INFO:root:Iteration [150/343]
INFO:root:Iteration [151/343]
INFO:root:Iteration [152/343]
INFO:root:Iteration [153/343]
INFO:root:Iteration [154/343]
INFO:root:Iteration [155/343]
INFO:root:Iteration [156/343]
INFO:root:Iteration [157/343]
INFO:root:Iteration [158/343]
INFO:root:Iteration [159/343]
INFO:root:Iteration [160/343]
INFO:root:Iteration [161/343]
INFO:root:Iteration [162/343]
INFO:root:Iteration [163/343]
INFO:root:Iteration [164/343]
INFO:root:Iteration [165/343]
INFO:root:Iteration [166/343]
INFO:root:Iteration [167/343]
INFO:root:Iteration [168/343]
INFO:root:Iteration [169/343]
INFO:root:Iteration [170/343]
INFO:root:Iteration [171/343]
INFO:root:Iteration [172/343]
INFO:root:Iteration [173/343]
INFO:root:Iteration [174/343]
INFO:root:Iteration [175/343]
INFO:root:Iteration [176/343]
INFO:root:Iteration [177/343]
INFO:root:Iteration [178/343]
INFO:root:Iteration [179/343]
INFO:root:Iteration [180/343]
INFO:root:Iteration [181/343]
INFO:root:Iteration [182/343]
INFO:root:Iteration [183/343]
INFO:root:Iteration [184/343]
INFO:root:Iteration [185/343]
INFO:root:Iteration [186/343]
INFO:root:Iteration [187/343]
INFO:root:Iteration [188/343]
INFO:root:Iteration [189/343]
INFO:root:Iteration [190/343]
INFO:root:Iteration [191/343]
INFO:root:Iteration [192/343]
INFO:root:Iteration [193/343]
INFO:root:Iteration [194/343]
INFO:root:Iteration [195/343]
INFO:root:Iteration [196/343]
INFO:root:Iteration [197/343]
INFO:root:Iteration [198/343]
INFO:root:Iteration [199/343]
INFO:root:Iteration [200/343]
INFO:root:Iteration [201/343]
INFO:root:Iteration [202/343]
INFO:root:Iteration [203/343]
INFO:root:Iteration [204/343]
INFO:root:Iteration [205/343]
INFO:root:Iteration [206/343]
INFO:root:Iteration [207/343]
INFO:root:Iteration [208/343]
INFO:root:Iteration [209/343]
INFO:root:Iteration [210/343]
INFO:root:Iteration [211/343]
INFO:root:Iteration [212/343]
INFO:root:Iteration [213/343]
INFO:root:Iteration [214/343]
INFO:root:Iteration [215/343]
INFO:root:Iteration [216/343]
INFO:root:Iteration [217/343]
INFO:root:Iteration [218/343]
INFO:root:Iteration [219/343]
INFO:root:Iteration [220/343]
INFO:root:Iteration [221/343]
INFO:root:Iteration [222/343]
INFO:root:Iteration [223/343]
INFO:root:Iteration [224/343]
INFO:root:Iteration [225/343]
INFO:root:Iteration [226/343]
INFO:root:Iteration [227/343]
INFO:root:Iteration [228/343]
INFO:root:Iteration [229/343]
INFO:root:Iteration [230/343]
INFO:root:Iteration [231/343]
INFO:root:Iteration [232/343]
INFO:root:Iteration [233/343]
INFO:root:Iteration [234/343]
INFO:root:Iteration [235/343]
INFO:root:Iteration [236/343]
INFO:root:Iteration [237/343]
INFO:root:Iteration [238/343]
INFO:root:Iteration [239/343]
INFO:root:Iteration [240/343]
INFO:root:Iteration [241/343]
INFO:root:Iteration [242/343]
INFO:root:Iteration [243/343]
INFO:root:Iteration [244/343]
INFO:root:Iteration [245/343]
INFO:root:Iteration [246/343]
INFO:root:Iteration [247/343]
INFO:root:Iteration [248/343]
INFO:root:Iteration [249/343]
INFO:root:Iteration [250/343]
INFO:root:Iteration [251/343]
INFO:root:Iteration [252/343]
INFO:root:Iteration [253/343]
INFO:root:Iteration [254/343]
INFO:root:Iteration [255/343]
INFO:root:Iteration [256/343]
INFO:root:Iteration [257/343]
INFO:root:Iteration [258/343]
INFO:root:Iteration [259/343]
INFO:root:Iteration [260/343]
INFO:root:Iteration [261/343]
INFO:root:Iteration [262/343]
INFO:root:Iteration [263/343]
INFO:root:Iteration [264/343]
INFO:root:Iteration [265/343]
INFO:root:Iteration [266/343]
INFO:root:Iteration [267/343]
INFO:root:Iteration [268/343]
INFO:root:Iteration [269/343]
INFO:root:Iteration [270/343]
INFO:root:Iteration [271/343]
INFO:root:Iteration [272/343]
INFO:root:Iteration [273/343]
INFO:root:Iteration [274/343]
INFO:root:Iteration [275/343]
INFO:root:Iteration [276/343]
INFO:root:Iteration [277/343]
INFO:root:Iteration [278/343]
INFO:root:Iteration [279/343]
INFO:root:Iteration [280/343]
INFO:root:Iteration [281/343]
INFO:root:Iteration [282/343]
INFO:root:Iteration [283/343]
INFO:root:Iteration [284/343]
INFO:root:Iteration [285/343]
INFO:root:Iteration [286/343]
INFO:root:Iteration [287/343]
INFO:root:Iteration [288/343]
INFO:root:Iteration [289/343]
INFO:root:Iteration [290/343]
INFO:root:Iteration [291/343]
INFO:root:Iteration [292/343]
INFO:root:Iteration [293/343]
INFO:root:Iteration [294/343]
INFO:root:Iteration [295/343]
INFO:root:Iteration [296/343]
INFO:root:Iteration [297/343]
INFO:root:Iteration [298/343]
INFO:root:Iteration [299/343]
INFO:root:Iteration [300/343]
INFO:root:Iteration [301/343]
INFO:root:Iteration [302/343]
INFO:root:Iteration [303/343]
INFO:root:Iteration [304/343]
INFO:root:Iteration [305/343]
INFO:root:Iteration [306/343]
INFO:root:Iteration [307/343]
INFO:root:Iteration [308/343]
INFO:root:Iteration [309/343]
INFO:root:Iteration [310/343]
INFO:root:Iteration [311/343]
INFO:root:Iteration [312/343]
INFO:root:Iteration [313/343]
INFO:root:Iteration [314/343]
INFO:root:Iteration [315/343]
INFO:root:Iteration [316/343]
INFO:root:Iteration [317/343]
INFO:root:Iteration [318/343]
INFO:root:Iteration [319/343]
INFO:root:Iteration [320/343]
INFO:root:Iteration [321/343]
INFO:root:Iteration [322/343]
INFO:root:Iteration [323/343]
INFO:root:Iteration [324/343]
INFO:root:Iteration [325/343]
INFO:root:Iteration [326/343]
INFO:root:Iteration [327/343]
INFO:root:Iteration [328/343]
INFO:root:Iteration [329/343]
INFO:root:Iteration [330/343]
INFO:root:Iteration [331/343]
INFO:root:Iteration [332/343]
INFO:root:Iteration [333/343]
INFO:root:Iteration [334/343]
INFO:root:Iteration [335/343]
INFO:root:Iteration [336/343]
INFO:root:Iteration [337/343]
INFO:root:Iteration [338/343]
INFO:root:Iteration [339/343]
INFO:root:Iteration [340/343]
INFO:root:Iteration [341/343]
INFO:root:Iteration [342/343]
INFO:root:Iteration [343/343]
INFO:root:Iteration [344/343]
Rank, 1 Cache keys 7641
Rank, 0 Cache keys 7633
Assertion
INFO:root:Total features gathered 1408034, problem size: 1408033
Process Process-1:
Traceback (most recent call last):
  File "/home/rtcalumby/miniconda3/envs/fgdcc/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/home/rtcalumby/miniconda3/envs/fgdcc/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/rtcalumby/adam/luciano/PlantCLEF2025/PlantCLEF2025/main_feature_extraction.py", line 44, in process_main
    app_main(args=params)
  File "/home/rtcalumby/adam/luciano/PlantCLEF2025/PlantCLEF2025/engine_feature_extraction.py", line 114, in main
    assert total == dataset_length, 'Cache not compatible, corrupted or missing'
AssertionError: Cache not compatible, corrupted or missing
